@startuml
actor App_Client as Client #FFD700
boundary "Система регистрации" as RegistrationSystem #FF00FF
queue "MQ" as MQ #FF1493
entity "Антифрод" as AntifraudSystem #8B0000
participant "Выпуск карты" as PrintingSystem #808000
participant "Отделение банка" as DistributionPoint #32CD32

skinparam responseMessageBelowArrow true
Client -[#blue]> RegistrationSystem: POST: "Заполненная анкета"
Client <[#green]-- RegistrationSystem: Response:  OK

skinparam sequenceMessageAlign center
alt#FF1493 Анкета прошла валидацию
    RegistrationSystem -[#blue]> MQ: POST: id{dataClient}
    skinparam responseMessageBelowArrow true
    MQ -[#blue]> AntifraudSystem: POST:id{dataClient}
    note right: Рассмотрение в теченни 24ч.
    MQ <[#green]-- AntifraudSystem : Response: OK
    MQ --[#F4A460]> Client: PUSH: "Ваша заявка на рассмотрении!"
    alt#FF1493 Фрод не пройден
        AntifraudSystem -[#red]> MQ: Отказ
        MQ --[#F4A460]> Client: PUSH: Вам отказано в получении карты!
    else Фрод пройден
        loop#FF6347 EVERY 3H
        MQ -[#blue]> AntifraudSystem: GET : Status{Client} : ok
        MQ <[#green]-- AntifraudSystem : Response: Actual Status{ID_Client}
        end
        AntifraudSystem -[#blue]> PrintingSystem: POST : Выпусти и отправь карту
        note right: До 3-х раб.дней!
        AntifraudSystem <[#green]-- PrintingSystem : Response: OK
        MQ --[#F4A460]> Client: PUSH: Ваша карта будет готова в теченни "Х" дней!
        note right: Отправка PUSH-уведомлений осуществляется с 8:00 до 22:00!
        loop#FF6347 EVERY MONING AT 8am
        DistributionPoint -[#blue]> PrintingSystem : GET : Staus ID_card
        skinparam responseMessageBelowArrow true
        DistributionPoint <[#green]-- PrintingSystem: POST : Переданно в отделение
        end
        DistributionPoint --[#F4A460]> Client: PUSH: Карта готова к выдаче! Приди и возьми ее cowboy &#128522;
    end
else Анкета не прошла валидацию
    RegistrationSystem --[#red]> Client: Response : УВЫ! Ты криво заполнил данные! Иди учись!
end
@enduml